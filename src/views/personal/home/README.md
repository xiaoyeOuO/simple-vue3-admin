# 个人首页图表功能说明

## 已实现的6个图表功能

### 1. 代码当量统计及趋势折线图
- **功能**：展示指定周期内的代码当量统计数据及随时间变化趋势
- **图表类型**：折线图（带区域填充）
- **交互功能**：日期范围选择器，可动态调整统计周期
- **数据格式**：
  ```json
  {
    "dates": ["2024-01", "2024-02", "2024-03", "2024-04", "2024-05", "2024-06"],
    "values": [120, 132, 101, 134, 90, 230]
  }
  ```

### 2. 缺陷类型分布饼图
- **功能**：展示个人缺陷总数按紧急程度分类（紧急、高级、中级、低级）
- **图表类型**：饼图
- **颜色方案**：紧急-红色、高级-橙色、中级-蓝色、低级-绿色
- **数据格式**：
  ```json
  [
    {"value": 2, "name": "紧急"},
    {"value": 5, "name": "高级"},
    {"value": 8, "name": "中级"},
    {"value": 3, "name": "低级"}
  ]
  ```

### 3. 遗留缺陷比例及趋势
- **功能**：展示各阶段遗留缺陷的比例，未解决遗留缺陷个数/缺陷总数的趋势
- **图表类型**：双折线图
- **数据维度**：时间维度（周/月）、未解决缺陷数、总缺陷数
- **数据格式**：
  ```json
  {
    "periods": ["第1周", "第2周", "第3周", "第4周", "第5周", "第6周"],
    "legacyDefects": [5, 8, 6, 9, 7, 5],
    "totalDefects": [10, 15, 12, 18, 14, 10]
  }
  ```

### 4. 缺陷处理耗时分布饼图
- **功能**：展示个人所有缺陷从待处理到已关闭的耗时周期分布
- **图表类型**：环形饼图
- **分档标准**：5天以内、5-15天、15-30天、30天以上
- **数据格式**：
  ```json
  [
    {"value": 8, "name": "5天以内"},
    {"value": 12, "name": "5-15天"},
    {"value": 6, "name": "15-30天"},
    {"value": 4, "name": "30天以上"}
  ]
  ```

### 5. A项目工时占比饼图
- **功能**：展示A项目中某人任务的认定总工时/A项目所有任务的认定总工时占比
- **图表类型**：饼图
- **交互功能**：项目选择器（可切换项目A/B/C）
- **数据格式**：
  ```json
  [
    {"value": 120, "name": "个人工时"},
    {"value": 280, "name": "项目总工时"}
  ]
  ```

### 6. 个人工时分布饼图
- **功能**：展示A项目中某人任务的认定总工时/某人所有任务的认定总工时占比
- **图表类型**：饼图
- **数据维度**：各项目工时分布
- **数据格式**：
  ```json
  [
    {"value": 120, "name": "A项目"},
    {"value": 80, "name": "B项目"},
    {"value": 60, "name": "C项目"},
    {"value": 40, "name": "其他项目"}
  ]
  ```

## 技术实现

### 图表库
- 使用 **ECharts** 作为图表渲染引擎
- 支持响应式布局，自动适应窗口大小变化

### 数据获取
- 当前使用模拟数据进行展示
- 已预留API接口，可无缝切换到真实后端数据

### 响应式设计
- 使用 Element Plus 的栅格系统实现响应式布局
- 移动端适配：图表高度调整、布局堆叠显示

## API接口规范

### 后端API端点

#### 1. 获取代码当量统计
```
GET /api/personal/code-equivalent?userId={userId}&startDate={startDate}&endDate={endDate}
```

#### 2. 获取缺陷类型统计
```
GET /api/personal/defect-types?userId={userId}
```

#### 3. 获取遗留缺陷趋势
```
GET /api/personal/legacy-defects?userId={userId}
```

#### 4. 获取缺陷处理耗时分布
```
GET /api/personal/defect-duration?userId={userId}
```

#### 5. 获取项目工时统计
```
GET /api/personal/project-hours?userId={userId}&projectId={projectId}
```

#### 6. 获取个人工时分布
```
GET /api/personal/work-hours?userId={userId}
```

## 使用说明

### 开发环境
1. 确保已安装依赖：`npm install echarts`
2. 开发服务器已运行在 `http://localhost:3000`

### 切换真实数据
1. 取消注释 `// import { personalApi } from '@/api/personal'`
2. 在 `fetchChartData` 方法中替换模拟数据调用为真实API调用
3. 根据实际后端API返回格式调整图表数据格式

### 自定义配置
- 图表颜色、样式可在对应的初始化方法中修改
- 日期范围、项目选择等交互功能已预留接口

## 示例截图

（此处应添加实际运行后的图表截图）

## 注意事项

1. **数据格式**：确保后端返回的数据格式与前端期望一致
2. **错误处理**：已添加错误处理逻辑，网络异常时会显示友好提示
3. **性能优化**：大数据量时建议添加loading状态和分页功能
4. **移动端**：在小屏设备上会自动调整布局和图表大小